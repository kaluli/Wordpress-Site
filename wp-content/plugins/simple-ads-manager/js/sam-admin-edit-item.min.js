var sam=sam||{};(function(n){var t,i=samEditorOptions.media,r=samEditorOptions.strings;sam.media=t={buttonId:"#banner-media",adUrl:"#ad_img",adImgId:"#ad_img_id",adName:"#title",adDesc:"#item_description",adAlt:"#ad_alt",init:function(){n(this.buttonId).on("click",this.openMediaDialog)},openMediaDialog:function(n){if(n.preventDefault(),this._frame){this._frame.open();return}this._frame=t.frame=wp.media({title:i.title,button:{text:i.button},multiple:!1,library:{type:"image"}});this._frame.on("ready",function(){});this._frame.state("library").on("select",function(){var n=this.get("selection").single();t.handleMediaAttachment(n)});this._frame.open()},handleMediaAttachment:function(t){var i=t.toJSON();n(this.adUrl).val(i.url);n(this.adImgId).val(i.id);""==n(this.adName).val()&&""!=i.title&&n(this.adName).val(i.title);""==n(this.adDesc).val()&&""!=i.caption&&n(this.adDesc).val(i.caption);""==n(this.adAlt).val()&&""!=i.alt&&n(this.adAlt).val(i.alt)}};n(document).ready(function(){function vr(t,i,r,u,f,e,o){var s=r.val();i.w2grid({name:t,show:{selectColumn:!0,toolbar:!0,footer:!0},multiSearch:!0,searches:o,multiSelect:!0,columns:f,url:e,limit:1e4,onSelect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}},onUnselect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}},onLoad:function(i){i.onComplete=function(){if(null!=s&&""!=s){var i=s.split(",");n.each(i,function(i,r){n.each(w2ui[t].records,function(n,i){var f=u=="id"?i.id:i.slug;return f==r?(w2ui[t].select(i.recid),!1):!0})})}}}})}function e(t,i,r,u,f,e){var o=r.val(),s;i.w2grid({name:t,show:{selectColumn:!0},multiSelect:!0,columns:f,records:e,onSelect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}},onUnselect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}}});null!=o&&""!=o&&(s=o.split(","),n.each(s,function(i,r){n.each(e,function(n,i){var f=u=="id"?i.id:i.slug;return f==r?(w2ui[t].select(i.recid),!1):!0})}))}var ef=n("#editor_mode").val(),gt=n("#title"),s=n("#rc-vt0"),h=n("#rc-vt2"),f=n("#x_id"),g=n("#rc-xid"),nt=n("#ad_cats"),at=n("#rc-ac"),ni=n("#acw"),c=n("#x_cats"),tt=n("#rc-xc"),it=n("#ad_custom_tax_terms"),vt=n("#rc-ctt"),ti=n("#cttw"),l=n("#x_ad_custom_tax_terms"),rt=n("#rc-xct"),ut=n("#ad_authors"),yt=n("#rc-au"),ii=n("#aaw"),a=n("#x_authors"),ft=n("#rc-xa"),et=n("#ad_tags"),pt=n("#rc-at"),ri=n("#atw"),v=n("#x_tags"),ot=n("#rc-xt"),st=n("#ad_custom"),wt=n("#rc-cu"),ui=n("#cuw"),y=n("#x_custom"),ht=n("#rc-xu"),ct=n("#x-view-users"),bt=n("#custom-users"),ur=n("#rc-cmf"),fr=n("#rc-cmt"),er=n("#ad_users_reg"),or=n("#x-reg-users"),sr=n("#x_ad_users"),of=n("#upload-file-button"),sf=n("#uploading"),hr=n("#uploading-help"),hf=n("#load_img"),p,fi=n("#ctt-grid"),hu=n("#view_custom_tax_terms"),ei=n("#x-ctt-grid"),cu=n("#x_view_custom_tax_terms"),oi=n("#posts-grid"),lu=n("#view_id"),lt=n("#users-grid"),au=n("#x_view_users"),si=n("#x-posts-grid"),vu=n("#x_view_id"),hi=n("#cats-grid"),yu=n("#view_cats"),ci=n("#x-cats-grid"),pu=n("#x_view_cats"),li=n("#auth-grid"),wu=n("#view_authors"),ai=n("#x-auth-grid"),bu=n("#x_view_authors"),vi=n("#tags-grid"),ku=n("#view_tags"),yi=n("#x-tags-grid"),du=n("#x_view_tags"),pi=n("#cust-grid"),gu=n("#view_custom"),wi=n("#x-cust-grid"),nf=n("#x_view_custom"),w=samEditorOptions.samAjaxUrl,cr=samEditorOptions.samStatsUrl,i=samEditorOptions.models,lr=samEditorOptions.searches,kt=samEditorOptions.data,u=samEditorOptions.strings,tf=encodeURI(u.posts),rf=encodeURI(u.page),uf,ar=n("#item_id").val(),bi=0,o,b=[],dt={animate:!0,animateReplot:!0,cursor:{showTooltip:!1},series:[{pointLabels:{show:!0},renderer:n.jqplot.BarRenderer,showHighlight:!1,rendererOptions:{animation:{speed:2500},barWidth:15,barPadding:-15,barMargin:0,highlightMouseOver:!1},label:u.labels.hits},{label:u.labels.clicks,rendererOptions:{animation:{speed:2e3}}}],axesDefaults:{pad:0},axes:{xaxis:{tickInterval:1,drawMajorGridlines:!1,drawMinorGridlines:!0,drawMajorTickMarks:!1,rendererOptions:{tickInset:1,minorTicks:1},min:1},yaxis:{rendererOptions:{forceTickAt0:!0}}},highlighter:{show:!0,showLabel:!0,tooltipAxes:"y",sizeAdjust:7.5,tooltipLocation:"ne",useAxesFormatters:!1,tooltipFormatString:u.labels.clicks+": %d"},legend:{show:!0,placement:"ne"}},nr,yr,tr,pr,wr,br,ir,kr,rr;gt.tooltip({track:!0});n("#image_tools").tabs();t.init();uf=n.post(cr,{action:"load_item_stats",id:ar,sm:bi}).done(function(t){n("#total_hits").text(t.total.hits);n("#total_clicks").text(t.total.clicks);b=[t.hits,t.clicks];o=n.jqplot("graph",b,dt)});var ki=n("#upload-console"),di=n("#upload-progress"),gi=samEditorOptions.uploader,ff=new plupload.Uploader({browse_button:"upload-file-button",url:gi.url+"?path="+gi.path,multi_selection:!1,filters:{max_file_size:"500kb",mime_types:[{title:"Image file",extensions:"jpg,jpeg,gif,png"},{title:"Flash file",extensions:"swf"}]},init:{PostInit:function(){ki.text("");di.text("")},FilesAdded:function(n,t){plupload.each(t,function(n){ki.text(n.name)});this.start()},UploadProgress:function(n,t){di.text(t.percent+"%")},UploadComplete:function(t,i){ki.text("");di.text("");n('<div id="files"><\/div>').appendTo(hr);n("#ad_img").val(gi.adUrl+i[0].name);n("#files").html("<p>"+r.file+" "+i[0].name+" "+r.uploaded+"<\/p>").addClass("updated").delay(3e3).fadeOut(1e3,function(){n(this).remove()})},Error:function(t,i){n('<div id="files"><\/div>').appendTo(hr);n("#files").html("<p>Error("+i.code+"): "+i.message+"<\/p>").addClass("error").delay(3e3).fadeOut(1e3,function(){n(this).remove()})}}});ff.init();n("#adv_nick").combogrid({url:w+"?action=load_combo_data",datatype:"json",munit:"px",alternate:!0,colModel:i.comboGrid,select:function(t,i){return n("#adv_nick").val(i.item.slug),n("#adv_name").val(i.item.title),n("#adv_mail").val(i.item.email),!1}});n("#add-file-button").click(function(){var t=u.url+n("select#files_list option:selected").val();return n("#ad_img").val(t),!1});e("ctt-grid",fi,hu,"slug",i.customTaxes,kt.cTax);e("x-ctt-grid",ei,cu,"slug",i.customTaxes,kt.cTax);e("cust-grid",pi,gu,"slug",i.customs,kt.customs);e("x-cust-grid",wi,nf,"slug",i.customs,kt.customs);nr=w+"?action=load_posts&cstr="+samEditorOptions.data.custList+"&sp="+tf+"&spg="+rf+"&limit=10000";vr("posts-grid",oi,lu,"id",i.posts,nr,lr.posts);vr("x-posts-grid",si,vu,"id",i.posts,nr,lr.posts);n("#tabs").tabs({activate:function(t,i){var r=i.newPanel[0].id;r=="tabs-1"&&w2ui["posts-grid"]&&oi.w2render("posts-grid");r=="tabs-2"&&(vt.is(":visible")&&w2ui["ctt-grid"]&&fi.w2render("ctt-grid"),rt.is(":visible")&&w2ui["x-ctt-grid"]&&ei.w2render("x-ctt-grid"),g.is(":visible")&&w2ui["x-posts-grid"]&&si.w2render("x-posts-grid"),at.is(":visible")&&w2ui["cats-grid"]&&hi.w2render("cats-grid"),tt.is(":visible")&&w2ui["x-cats-grid"]&&ci.w2render("x-cats-grid"),yt.is(":visible")&&w2ui["auth-grid"]&&li.w2render("auth-grid"),ft.is(":visible")&&w2ui["x-auth-grid"]&&ai.w2render("x-auth-grid"),pt.is(":visible")&&w2ui["tags-grid"]&&vi.w2render("tags-grid"),ot.is(":visible")&&w2ui["x-tags-grid"]&&yi.w2render("x-tags-grid"),wt.is(":visible")&&w2ui["cust-grid"]&&pi.w2render("cust-grid"),ht.is(":visible")&&w2ui["xcust-grid"]&&wi.w2render("x-cust-grid"));r=="tabs-3"&&ct.is(":visible")&&w2ui["users-grid"]&&lt.w2render("users-grid");r=="tabs-5"&&o&&(o.destroy(),o=n.jqplot("graph",b,dt))}});n(window).resize(function(){o&&(o.destroy(),o=n.jqplot("graph",b,dt))});n("#code_mode_false").click(function(){ur.show("blind",{direction:"vertical"},500);fr.hide("blind",{direction:"vertical"},500)});n("#code_mode_true").click(function(){ur.hide("blind",{direction:"vertical"},500);fr.show("blind",{direction:"vertical"},500)});2==n("input:radio[name=view_type]:checked").val()&&(f.is(":checked")&&(f.attr("checked",!1),g.hide("blind",{direction:"vertical"},500)),f.attr("disabled",!0));n("input:radio[name=view_type]").click(function(){var t=n("input:radio[name=view_type]:checked").val();switch(t){case"0":s.is(":hidden")&&s.show("blind",{direction:"vertical"},500);h.is(":visible")&&h.hide("blind",{direction:"vertical"},500);f.attr("disabled",!1);break;case"1":s.is(":visible")&&s.hide("blind",{direction:"vertical"},500);h.is(":visible")&&h.hide("blind",{direction:"vertical"},500);f.attr("disabled",!1);break;case"2":s.is(":visible")&&s.hide("blind",{direction:"vertical"},500);h.is(":hidden")&&(h.show("blind",{direction:"vertical"},500,function(){w2ui["posts-grid"]&&oi.w2render("posts-grid")}),f.is(":checked")&&(f.attr("checked",!1),g.hide("blind",{direction:"vertical"},500)));f.attr("disabled",!0)}});yr=n.ajax({url:w,data:{action:"load_authors",level:3},type:"POST"});yr.done(function(n){tr=n;e("auth-grid",li,wu,"slug",i.authors,tr);e("x-auth-grid",ai,bu,"slug",i.authors,tr)});pr=n.ajax({url:w,data:{action:"load_users",subscriber:encodeURI(u.subscriber),contributor:encodeURI(u.contributor),author:encodeURI(u.author),editor:encodeURI(u.editor),admin:encodeURI(u.admin),sadmin:encodeURI(u.superAdmin)},type:"POST"});pr.done(function(n){wr=n;e("users-grid",lt,au,"slug",i.users,wr)});br=n.ajax({url:w,data:{action:"load_cats",level:3},type:"POST"});br.done(function(n){ir=n;e("cats-grid",hi,yu,"slug",i.cats,ir);e("x-cats-grid",ci,pu,"slug",i.cats,ir)});kr=n.ajax({url:w,data:{action:"load_tags",level:3},type:"POST"});kr.done(function(n){rr=n;e("tags-grid",vi,ku,"slug",i.tags,rr);e("x-tags-grid",yi,du,"slug",i.tags,rr)});f.click(function(){f.is(":checked")?2==n("input:radio[name=view_type]:checked").val()?f.attr("checked",!1):g.show("blind",{direction:"vertical"},500,function(){w2ui["x-posts-grid"]&&si.w2render("x-posts-grid")}):g.hide("blind",{direction:"vertical"},500)});n("input:radio[name=ad_users]").click(function(){var t=n("input:radio[name=ad_users]:checked").val();t=="0"?bt.is(":visible")&&bt.hide("blind",{direction:"vertical"},500):bt.is(":hidden")&&bt.show("blind",{direction:"vertical"},500,function(){ct.is(":visible")&&w2ui["users-grid"]&&lt.w2render("users-grid")})});er.click(function(){er.is(":checked")?or.show("blind",{direction:"vertical"},500,function(){ct.is(":visible")&&w2ui["users-grid"]&&lt.w2render("users-grid")}):or.hide("blind",{direction:"vertical"},500)});sr.click(function(){sr.is(":checked")?ct.show("blind",{direction:"vertical"},500,function(){w2ui["users-grid"]&&lt.w2render("users-grid")}):ct.hide("blind",{direction:"vertical"},500)});n("#ad_swf").click(function(){n("#ad_swf").is(":checked")?n("#swf-params").show("blind",{direction:"vertical"},500):n("#swf-params").hide("blind",{direction:"vertical"},500)});nt.is(":checked")&&c.is(":checked")&&(c.attr("checked",!1),tt.hide("blind",{direction:"vertical"},500));nt.click(function(){nt.is(":checked")?(at.show("blind",{direction:"vertical"},500,function(){w2ui["cats-grid"]&&hi.w2render("cats-grid")}),ni.show("blind",{direction:"vertical"},500),c.is(":checked")&&(c.attr("checked",!1),tt.hide("blind",{direction:"vertical"},500))):(at.hide("blind",{direction:"vertical"},500),ni.hide("blind",{direction:"vertical"},500))});c.click(function(){c.is(":checked")?(tt.show("blind",{direction:"vertical"},500,function(){w2ui["x-cats-grid"]&&ci.w2render("x-cats-grid")}),nt.is(":checked")&&(nt.attr("checked",!1),at.hide("blind",{direction:"vertical"},500),ni.hide("blind",{direction:"vertical"},500))):tt.hide("blind",{direction:"vertical"},500)});it.is(":checked")&&l.is(":checked")&&(l.attr("checked",!1),rt.hide("blind",{direction:"vertical"},500));it.click(function(){it.is(":checked")?(vt.show("blind",{direction:"vertical"},500,function(){w2ui["ctt-grid"]&&fi.w2render("ctt-grid")}),ti.show("blind",{direction:"vertical"},500),l.is(":checked")&&(l.attr("checked",!1),rt.hide("blind",{direction:"vertical"},500))):(vt.hide("blind",{direction:"vertical"},500),ti.hide("blind",{direction:"vertical"},500))});l.click(function(){l.is(":checked")?(rt.show("blind",{direction:"vertical"},500,function(){w2ui["x-ctt-grid"]&&ei.w2render("x-ctt-grid")}),it.is(":checked")&&(it.attr("checked",!1),vt.hide("blind",{direction:"vertical"},500),ti.hide("blind",{direction:"vertical"},500))):rt.hide("blind",{direction:"vertical"},500)});ut.is(":checked")&&a.is(":checked")&&(a.attr("checked",!1),ft.hide("blind",{direction:"vertical"},500));ut.click(function(){ut.is(":checked")?(yt.show("blind",{direction:"vertical"},500,function(){w2ui["auth-grid"]&&li.w2render("auth-grid")}),ii.show("blind",{direction:"vertical"},500),a.is(":checked")&&(a.attr("checked",!1),ft.hide("blind",{direction:"vertical"},500))):(yt.hide("blind",{direction:"vertical"},500),ii.hide("blind",{direction:"vertical"},500))});a.click(function(){a.is(":checked")?(ft.show("blind",{direction:"vertical"},500,function(){w2ui["x-auth-grid"]&&ai.w2render("x-auth-grid")}),ut.is(":checked")&&(ut.attr("checked",!1),yt.hide("blind",{direction:"vertical"},500),ii.hide("blind",{direction:"vertical"},500))):ft.hide("blind",{direction:"vertical"},500)});et.is(":checked")&&v.is(":checked")&&(v.attr("checked",!1),ot.hide("blind",{direction:"vertical"},500));et.click(function(){et.is(":checked")?(pt.show("blind",{direction:"vertical"},500,function(){w2ui["tags-grid"]&&vi.w2render("tags-grid")}),ri.show("blind",{direction:"vertical"},500),v.is(":checked")&&(v.attr("checked",!1),ot.hide("blind",{direction:"vertical"},500))):(pt.hide("blind",{direction:"vertical"},500),ri.hide("blind",{direction:"vertical"},500))});v.click(function(){v.is(":checked")?(ot.show("blind",{direction:"vertical"},500,function(){w2ui["x-tags-grid"]&&yi.w2render("x-tags-grid")}),et.is(":checked")&&(et.attr("checked",!1),pt.hide("blind",{direction:"vertical"},500),ri.hide("blind",{direction:"vertical"},500))):ot.hide("blind",{direction:"vertical"},500)});st.is(":checked")&&y.is(":checked")&&(y.attr("checked",!1),ht.hide("blind",{direction:"vertical"},500));st.click(function(){st.is(":checked")?(wt.show("blind",{direction:"vertical"},500,function(){w2ui["cust-grid"]&&pi.w2render("cust-grid")}),ui.show("blind",{direction:"vertical"},500),y.is(":checked")&&(y.attr("checked",!1),ht.hide("blind",{direction:"vertical"},500))):(wt.hide("blind",{direction:"vertical"},500),ui.hide("blind",{direction:"vertical"},500))});y.click(function(){y.is(":checked")?(ht.show("blind",{direction:"vertical"},500,function(){w2ui["x-cust-grid"]&&wi.w2render("x-cust-grid")}),st.is(":checked")&&(st.attr("checked",!1),wt.hide("blind",{direction:"vertical"},500),ui.hide("blind",{direction:"vertical"},500))):ht.hide("blind",{direction:"vertical"},500)});n("#ad_start_date, #ad_end_date").datepicker({dateFormat:"yy-mm-dd",showButtonPanel:!0});n("#ad_schedule").click(function(){n("#ad_schedule").is(":checked")?n("#rc-sc").show("blind",{direction:"vertical"},500):n("#rc-sc").hide("blind",{direction:"vertical"},500)});n("#limit_hits").click(function(){n("#limit_hits").is(":checked")?n("#rc-hl").show("blind",{direction:"vertical"},500):n("#rc-hl").hide("blind",{direction:"vertical"},500)});n("#limit_clicks").click(function(){n("#limit_clicks").is(":checked")?n("#rc-cl").show("blind",{direction:"vertical"},500):n("#rc-cl").hide("blind",{direction:"vertical"},500)});p=samEditorOptions.ads;p.pointer="ads";(p.enabled||""==gt.val())&&gt.pointer({content:"<h3>"+p.title+"<\/h3><p>"+p.content+"<\/p>",position:"top",close:function(){n.ajax({url:ajaxurl,data:{action:"close_pointer",pointer:p.pointer},async:!0})}}).pointer("open");var k=n("#is_singular"),dr=n("#is_single"),gr=n("#is_page"),nu=n("#is_attachment"),tu=n("#is_posttype");k.click(function(){k.is(":checked")&&n("#is_single, #is_page, #is_attachment, #is_posttype").attr("checked",!0)});n("#is_single, #is_page, #is_attachment, #is_posttype").click(function(){!k.is(":checked")||dr.is(":checked")&&gr.is(":checked")&&nu.is(":checked")&&tu.is(":checked")?!k.is(":checked")&&dr.is(":checked")&&tu.is(":checked")&&gr.is(":checked")&&nu.is(":checked")&&k.attr("checked",!0):k.attr("checked",!1)});var d=n("#is_archive"),iu=n("#is_tax"),ru=n("#is_category"),uu=n("#is_tag"),fu=n("#is_author"),eu=n("#is_date"),ou=n("#is_posttype_archive"),su=n("#is_tax, #is_category, #is_tag, #is_author, #is_date, #is_posttype_archive");return d.click(function(){d.is(":checked")&&su.attr("checked",!0)}),su.click(function(){!d.is(":checked")||iu.is(":checked")&&ru.is(":checked")&&ou.is(":checked")&&uu.is(":checked")&&fu.is(":checked")&&eu.is(":checked")?!d.is(":checked")&&iu.is(":checked")&&ru.is(":checked")&&ou.is(":checked")&&uu.is(":checked")&&fu.is(":checked")&&eu.is(":checked")&&d.attr("checked",!0):d.attr("checked",!1)}),n("#stats_month").change(function(){bi=n(this).val();n.post(cr,{action:"load_item_stats",id:ar,sm:bi}).done(function(t){n("#total_hits").text(t.total.hits);n("#total_clicks").text(t.total.clicks);b=[t.hits,t.clicks];o&&(o.destroy(),o=n.jqplot("graph",b,dt))})}),!1})})(jQuery)